(* ============================= *)
(* C++ Subset Grammar (EBNF)     *)
(* ============================= *)

program
    = { declaration } ;

(* ---------- Declarations ---------- *)

declaration
    = variable_decl
    | function_decl
    | function_def ;

type
    = "int"
    | "float"
    | "double"
    | "char"
    | "void"
    | identifier ;

variable_decl
    = type identifier [ "=" expression ] ";" ;

function_decl
    = type identifier "(" [ parameter_list ] ")" ";" ;

function_def
    = type identifier "(" [ parameter_list ] ")" compound_stmt ;

parameter_list
    = parameter { "," parameter } ;

parameter
    = type identifier ;

(* ---------- Statements ---------- *)

statement
    = compound_stmt
    | expression_stmt
    | selection_stmt
    | iteration_stmt
    | jump_stmt
    | variable_decl ;

compound_stmt
    = "{" { statement } "}" ;

expression_stmt
    = [ expression ] ";" ;

selection_stmt
    = "if" "(" expression ")" statement
      [ "else" statement ] ;

iteration_stmt
    = "while" "(" expression ")" statement
    | "for" "(" [ expression ] ";" [ expression ] ";" [ expression ] ")" statement ;

jump_stmt
    = "return" [ expression ] ";" ;

(* ---------- Expressions ---------- *)

expression
    = assignment ;

assignment
    = logical_or [ "=" assignment ] ;

logical_or
    = logical_and { "||" logical_and } ;

logical_and
    = equality { "&&" equality } ;

equality
    = relational { ( "==" | "!=" ) relational } ;

relational
    = additive { ( "<" | ">" | "<=" | ">=" ) additive } ;

additive
    = multiplicative { ( "+" | "-" ) multiplicative } ;

multiplicative
    = unary { ( "*" | "/" | "%" ) unary } ;

unary
    = ( "+" | "-" | "!" ) unary
    | primary ;

primary
    = literal
    | identifier
    | function_call
    | "(" expression ")" ;

function_call
    = identifier "(" [ argument_list ] ")" ;

argument_list
    = expression { "," expression } ;

(* ---------- Lexical Elements ---------- *)

literal
    = integer_literal
    | floating_literal
    | char_literal
    | string_literal ;

identifier
    = letter { letter | digit | "_" } ;

integer_literal
    = digit { digit } ;

floating_literal
    = digit { digit } "." digit { digit } ;

char_literal
    = "'" character "'" ;

string_literal
    = '"' { character } '"' ;

letter
    = "A" | "B" | "C" | "D" | "E" | "F" | "G"
    | "H" | "I" | "J" | "K" | "L" | "M" | "N"
    | "O" | "P" | "Q" | "R" | "S" | "T" | "U"
    | "V" | "W" | "X" | "Y" | "Z"
    | "a" | "b" | "c" | "d" | "e" | "f" | "g"
    | "h" | "i" | "j" | "k" | "l" | "m" | "n"
    | "o" | "p" | "q" | "r" | "s" | "t" | "u"
    | "v" | "w" | "x" | "y" | "z" ;

digit
    = "0" | "1" | "2" | "3" | "4"
    | "5" | "6" | "7" | "8" | "9" ;

character
    = ? any character except quote ? ;
